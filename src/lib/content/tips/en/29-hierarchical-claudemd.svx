
One CLAUDE.md file works fine until you have a monorepo. Or a large codebase. Or a team with different preferences. That's when the [hierarchical memory system](https://code.claude.com/docs/en/memory) becomes essential.

## The Priority Hierarchy

Claude loads memory files from multiple locations. Higher priority wins when instructions conflict:

| Priority | Location | Purpose | Shared With |
|----------|----------|---------|-------------|
| Highest | Enterprise directories | Organization-wide policies | All org users |
| High | `./CLAUDE.md` | Team standards | Team via git |
| Medium | `./.claude/rules/*.md` | Modular topic rules | Team via git |
| Low | `~/.claude/CLAUDE.md` | Personal global preferences | Just you |
| Lowest | `./CLAUDE.local.md` | Personal project overrides | Just you |

Enterprise policies can't be overridden. Everything else merges, with project rules taking precedence over personal preferences.

## How Claude Discovers Files

Starting from your current working directory, Claude searches upward toward root, loading every `CLAUDE.md` and `CLAUDE.local.md` it finds.

```
# If you run claude from project/src/api/
# These all load automatically:

~/.claude/CLAUDE.md           # Global (always loads)
project/CLAUDE.md             # Project root
project/src/CLAUDE.md         # Parent directory
project/src/api/CLAUDE.md     # Current directory
```

Subdirectory CLAUDE.md files load on-demand. Claude only pulls in `project/src/backend/CLAUDE.md` when it actually reads files from that directory. This prevents token waste on irrelevant context.

## The `.claude/rules/` Directory

[Introduced in v2.0.64](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md), this directory lets you split instructions into focused files instead of one monolithic CLAUDE.md:

```
.claude/
├── CLAUDE.md              # Main project instructions
└── rules/
    ├── code-style.md      # Code conventions
    ├── testing.md         # Test requirements
    ├── security.md        # Security policies
    └── frontend/
        ├── react.md       # React patterns
        └── styles.md      # Styling guidelines
```

All `.md` files here automatically load with the same priority as CLAUDE.md. Subdirectories work too.

You can also create personal rules at `~/.claude/rules/` that apply to all your projects. These load before project rules, so project rules take precedence.

### Path-Specific Rules

Scope rules to specific file patterns using YAML frontmatter:

```markdown

# API Development Rules

- All endpoints must include input validation with Zod
- Return consistent error response shapes
- Log all requests with correlation IDs
```

This rule only activates when Claude works on matching files. Your API guidelines don't compete for attention when you're editing React components.

**YAML syntax note**: [Glob patterns starting with `*` or `{` must be quoted](https://github.com/anthropics/claude-code/issues/13905). Use `"**/*.ts"` not `**/*.ts`. Use `"{src,lib}/**/*.ts"` not `{src,lib}/**/*.ts`.

| Pattern | Matches |
|---------|---------|
| `"**/*.ts"` | All TypeScript files |
| `"src/**/*"` | All files under src/ |
| `"{src,lib}/**/*.ts"` | Multiple directories |
| `"tests/**/*.test.ts"` | Test files specifically |

Rules without a `paths` field load unconditionally.

## Import Syntax with `@`

Pull in additional files using `@path/to/import`:

```markdown
# Project Instructions

See @README for project overview.
See @package.json for available npm commands.

# Team Guidelines
- Git workflow: @docs/git-instructions.md
- API patterns: @docs/api-conventions.md
- Personal overrides: @~/.claude/my-preferences.md
```

Imports resolve both relative and absolute paths. Recursive imports work up to 5 levels deep. Imports inside code blocks are ignored.

The home directory syntax (`@~/.claude/...`) is useful for team members who want personal instructions that aren't checked into the repository.

**Important**: Imports don't reduce context size. The referenced content still loads into memory at startup. They're for organization, not optimization.

## Monorepo Strategy

[One developer reduced their CLAUDE.md from 47k to 9k words](https://dev.to/anvodev/how-i-organized-my-claudemd-in-a-monorepo-with-too-many-contexts-37k7) by splitting context across services:

```
monorepo/
├── CLAUDE.md              # Shared: workspace structure, commit conventions
├── apps/
│   ├── web/
│   │   └── CLAUDE.md      # React patterns, component library
│   └── api/
│       └── CLAUDE.md      # API conventions, validation rules
├── packages/
│   └── shared/
│       └── CLAUDE.md      # Shared utilities documentation
└── .claude/
    └── rules/
        ├── testing.md     # Universal test conventions
        └── security.md    # Security requirements
```

Backend components don't need frontend guides. Each subdirectory CLAUDE.md only loads when Claude accesses files there.

## Enterprise Deployment

Organizations can deploy CLAUDE.md and managed-settings.json to system directories:

| OS | Enterprise Location |
|----|---------------------|
| macOS | `/Library/Application Support/ClaudeCode/` |
| Linux/WSL | `/etc/claude-code/` |
| Windows | `C:\Program Files\ClaudeCode\` |

These require administrator privileges. Deploy via MDM, Group Policy, or Ansible. Users can't override enterprise settings, making them useful for security policies and coding standards that must apply everywhere.

## Configuration by Team Size

**Solo Developer**
```
~/.claude/CLAUDE.md          # Personal preferences
project/CLAUDE.md            # Project context
project/CLAUDE.local.md      # Experiments, temporary overrides
```

**Small Team (2-5)**
```
project/CLAUDE.md            # Shared standards
.claude/rules/               # Modular, reviewable rules
project/CLAUDE.local.md      # Personal workflow tweaks (gitignored)
```

**Large Team / Enterprise**
```
/etc/claude-code/CLAUDE.md   # Company policies (IT-deployed)
project/CLAUDE.md            # Project standards
.claude/rules/               # Domain-specific rules
~/.claude/CLAUDE.md          # Personal preferences (within policy)
```

## Best Practices

**Do:**
- Keep each file under 500 lines. Smaller files are easier to review.
- Use descriptive filenames: `api-validation.md` over `rules1.md`
- Version control everything. Rules are code.
- Test that Claude actually follows your rules. Instructions that don't work add noise.

**Don't:**
- Duplicate content across levels. Put shared rules in the root CLAUDE.md.
- Add path-specific frontmatter for broad guidelines. Unconditional rules are simpler.
- Exceed 10k words total across all files. [Research shows instruction-following degrades uniformly](https://www.humanlayer.dev/blog/writing-a-good-claude-md) as instruction count increases.
- Put secrets in CLAUDE.md. Use `.env` files and deny rules instead.

## Debugging

Run `/memory` to see all loaded memory files in your current session. This shows exactly which files Claude loaded and helps debug why certain rules aren't being applied.

If subdirectory CLAUDE.md files aren't loading when expected, check that Claude actually accessed files in that directory. On-demand loading only triggers when Claude reads or writes files there.

## Migration

If your CLAUDE.md has grown unwieldy:

1. Group instructions by domain (API, frontend, testing, security)
2. Move domain-specific content to `.claude/rules/`
3. Add path targeting where rules truly apply to specific file types
4. Test that Claude still follows your most important instructions
5. Keep only universal context in the root CLAUDE.md

When everything competes for attention, nothing stands out. A focused 50-line file outperforms a comprehensive 500-line file.
